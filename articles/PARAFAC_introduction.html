<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to PARAFAC modelling • parafac4microbiome</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to PARAFAC modelling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parafac4microbiome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Fujita2023_analysis.html">Fujita2023_analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PARAFAC_introduction.html">Introduction to PARAFAC modelling</a></li>
    <li><a class="dropdown-item" href="../articles/Shao2019_analysis.html">Shao2019_analysis</a></li>
    <li><a class="dropdown-item" href="../articles/vanderPloeg2024_analysis.html">vanderPloeg2024_analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to PARAFAC modelling</h1>
            
      

      <div class="d-none name"><code>PARAFAC_introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to the <code>parafac4microbiome</code> R package! In this
vignette we explain the data available in this package, how you can
model them using PARAFAC and how to plot the outcome. We require the
following packages and dependencies.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/">parafac4microbiome</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>The <code>parafac4microbiome</code> package comes with three
datasets: <code>Fujita2023</code>, <code>Shao2019</code> and
<code>vanderPloeg2024</code>. These refer to the first authors of their
respective papers. Each of the dataset objects are lists with the
following contents:</p>
<ul>
<li>data: the data cube of microbiome counts.</li>
<li>mode1: metadata corresponding to the subject mode.</li>
<li>mode2: metadata corresponding to the feature (microbial abundances)
mode.</li>
<li>mode3: metadata corresponding to the time mode.</li>
</ul>
<p>We briefly show what the data in these datasets look like and then
focus on <code>Fujita2023</code> for the remainder of this vignette. For
details on the datasets we refer to the parafac4microbiome paper and to
the original papers as listed in their respective help files. Modelling
and component selection are explained in more detail in the vignettes
corresponding to each dataset:
<code><a href="../articles/Fujita2023_analysis.html">vignette("Fujita2023_analysis")</a></code>,
<code><a href="../articles/Shao2019_analysis.html">vignette("Shao2019_analysis")</a></code> and
<code><a href="../articles/vanderPloeg2024_analysis.html">vignette("vanderPloeg2024_analysis")</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Fujita2023</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   8  28 110</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Shao2019</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 395 959   4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">vanderPloeg2024</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   41 2253    7</span></span>
<span></span>
<span><span class="co"># We focus on Fujita2023</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Fujita2023</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]</span></span>
<span><span class="co">#&gt; [1,] 11932    0    0    0    0    0    0    0    0   113     0   161     0</span></span>
<span><span class="co">#&gt; [2,] 11532    0    0    0    0    0    0    0    0     0     0     0     0</span></span>
<span><span class="co">#&gt; [3,] 10331    0    0    0    0    0    0    0    0   236     0     0  1824</span></span>
<span><span class="co">#&gt; [4,] 11528    0    0    0    0    0    0    0    0     0     0     0     0</span></span>
<span><span class="co">#&gt; [5,] 13735    0    0    0    0    0    0    0    0   139     0     0     0</span></span>
<span><span class="co">#&gt; [6,]  9167    0    0    0    0    0    0    0    0   247     0     0     0</span></span>
<span><span class="co">#&gt;      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]</span></span>
<span><span class="co">#&gt; [1,]     0     0     0     0     0   719     0     0     0     0     0   230</span></span>
<span><span class="co">#&gt; [2,]     0     0     0     0     0     0     0    38     0     0     0     0</span></span>
<span><span class="co">#&gt; [3,]     0     0     0     0     0     0     0     0     0     0   162     0</span></span>
<span><span class="co">#&gt; [4,]     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; [5,]   217     0     0     0     0   239     0     0    67     0     0     0</span></span>
<span><span class="co">#&gt; [6,]     0     0     0     0     0     0     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt;      [,26] [,27] [,28]</span></span>
<span><span class="co">#&gt; [1,]     0     0     0</span></span>
<span><span class="co">#&gt; [2,]     0     0   231</span></span>
<span><span class="co">#&gt; [3,]     0     0     0</span></span>
<span><span class="co">#&gt; [4,]     0     0     0</span></span>
<span><span class="co">#&gt; [5,]     0     0     0</span></span>
<span><span class="co">#&gt; [6,]     0     0     0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Fujita2023</span><span class="op">$</span><span class="va">mode1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 1</span></span></span>
<span><span class="co">#&gt;   replicate.id</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>            2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>            3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>            4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>            6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Fujita2023</span><span class="op">$</span><span class="va">mode2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID  Kingdom         Phylum               Class</span></span>
<span><span class="co">#&gt; 1 X_0002 Bacteria Proteobacteria Gammaproteobacteria</span></span>
<span><span class="co">#&gt; 2 X_0004 Bacteria     Firmicutes          Clostridia</span></span>
<span><span class="co">#&gt; 3 X_0007 Bacteria Proteobacteria Gammaproteobacteria</span></span>
<span><span class="co">#&gt; 4 X_0008 Bacteria Proteobacteria Gammaproteobacteria</span></span>
<span><span class="co">#&gt; 5 X_0010 Bacteria Proteobacteria Gammaproteobacteria</span></span>
<span><span class="co">#&gt; 6 X_0015 Bacteria     Firmicutes          Clostridia</span></span>
<span><span class="co">#&gt;                                 Order                Family</span></span>
<span><span class="co">#&gt; 1                       Aeromonadales        Aeromonadaceae</span></span>
<span><span class="co">#&gt; 2 Peptostreptococcales-Tissierellales Peptostreptococcaceae</span></span>
<span><span class="co">#&gt; 3                     Burkholderiales      Burkholderiaceae</span></span>
<span><span class="co">#&gt; 4                     Burkholderiales      Burkholderiaceae</span></span>
<span><span class="co">#&gt; 5                    Enterobacterales          unidentified</span></span>
<span><span class="co">#&gt; 6                      Lachnospirales       Lachnospiraceae</span></span>
<span><span class="co">#&gt;                                        Genus      Species</span></span>
<span><span class="co">#&gt; 1                                  Aeromonas unidentified</span></span>
<span><span class="co">#&gt; 2                             Clostridioides   mangenotii</span></span>
<span><span class="co">#&gt; 3                                  Pandoraea unidentified</span></span>
<span><span class="co">#&gt; 4 Burkholderia-Caballeronia-Paraburkholderia unidentified</span></span>
<span><span class="co">#&gt; 5                               unidentified unidentified</span></span>
<span><span class="co">#&gt; 6                          Lachnoclostridium unidentified</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Fujita2023</span><span class="op">$</span><span class="va">mode3</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 1</span></span></span>
<span><span class="co">#&gt;    time</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<div class="section level3">
<h3 id="processing-the-data-cube">Processing the data cube<a class="anchor" aria-label="anchor" href="#processing-the-data-cube"></a>
</h3>
<p>As shown above, the data cube in Fujita2023$data contains unprocessed
counts. The function <code><a href="../reference/processDataCube.html">processDataCube()</a></code> performs the
processing of these counts with the following steps:</p>
<ul>
<li>It performs feature selection based on the sparsityThreshold
setting. Sparsity is here defined as the fraction of samples where a
microbial abundance (ASV/OTU or otherwise) is zero.</li>
<li>It performs a centered log-ratio transformation of each sample using
the <code><a href="https://rdrr.io/pkg/compositions/man/clr.html" class="external-link">compositions::clr()</a></code> function with a pseudo-count of one
(on all features, prior to selection based on sparsity).</li>
<li>It centers and scales the three-way array. This is a complex
subject, for which we refer to a <a href="https://doi.org/10.1002/cem.773" class="external-link">paper by Rasmus Bro and Age
Smilde</a>. By centering across the subject mode, we make the subjects
comparable to each other within each time point. Scaling within the
feature mode avoids the PARAFAC model focussing on features with
abnormally high variation.</li>
</ul>
<p>The outcome of processing is a new version of the dataset. Please
refer to the documentation of <code><a href="../reference/processDataCube.html">processDataCube()</a></code> for more
information.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processedFujita</span> <span class="op">=</span> <span class="fu"><a href="../reference/processDataCube.html">processDataCube</a></span><span class="op">(</span><span class="va">Fujita2023</span>, sparsityThreshold<span class="op">=</span><span class="fl">0.99</span>, CLR<span class="op">=</span><span class="cn">TRUE</span>, centerMode<span class="op">=</span><span class="fl">1</span>, scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">processedFujita</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         [,1]   [,2]    [,3]    [,4]    [,5]   [,6]    [,7]    [,8]   [,9]</span></span>
<span><span class="co">#&gt; [1,] -0.5098 -0.265 -0.2669 -0.2743 -0.3655 -0.562 -0.2923 -0.5410 -0.890</span></span>
<span><span class="co">#&gt; [2,]  0.0763  0.017  0.0171  0.0176  0.0234  0.036  0.0187  0.0346  0.057</span></span>
<span><span class="co">#&gt; [3,] -0.5155 -0.179 -0.1797 -0.1847 -0.2461 -0.378 -0.1969 -0.3644 -0.600</span></span>
<span><span class="co">#&gt; [4,]  0.5277  0.218  0.2197  0.2258  0.3008  0.462  0.2406  0.4454  0.733</span></span>
<span><span class="co">#&gt; [5,] -0.2311 -0.228 -0.2296 -0.2359 -0.3144 -0.483 -0.2514 -0.4653 -0.766</span></span>
<span><span class="co">#&gt; [6,] -0.0526  0.102  0.1022  0.1050  0.1399  0.215  0.1119  0.2071  0.341</span></span>
<span><span class="co">#&gt;       [,10]  [,11]  [,12]  [,13]  [,14]   [,15]   [,16] [,17]   [,18]  [,19]</span></span>
<span><span class="co">#&gt; [1,]  0.544 -0.862 -1.703 -0.495 -0.672 -0.4608 -0.2023  9.04 -0.9420 -1.199</span></span>
<span><span class="co">#&gt; [2,] -0.805 -0.575 -0.998 -0.272  0.043  0.0295  0.0130 -2.88  0.0603  4.373</span></span>
<span><span class="co">#&gt; [3,]  0.818  3.962 -1.487 -0.427 -0.453 -0.3104 -0.1363 -3.50 -0.6344 -1.010</span></span>
<span><span class="co">#&gt; [4,] -0.703 -0.369 -0.495 -0.114  0.553  0.3793  0.1666 -2.25  0.7754 -0.142</span></span>
<span><span class="co">#&gt; [5,]  0.627 -0.824  6.713 -0.466 -0.578 -0.3964 -0.1740  7.02 -0.8102 -1.118</span></span>
<span><span class="co">#&gt; [6,]  0.975 -0.488 -0.787 -0.206  0.257  0.1764  0.0775 -2.62  0.3607 -0.398</span></span>
<span><span class="co">#&gt;        [,20]  [,21]   [,22]   [,23]</span></span>
<span><span class="co">#&gt; [1,] -0.3990 10.070 -0.6812 -0.7411</span></span>
<span><span class="co">#&gt; [2,]  0.0255 -1.517  0.0436  0.0474</span></span>
<span><span class="co">#&gt; [3,] -0.2687 -2.252 -0.4588 -0.4991</span></span>
<span><span class="co">#&gt; [4,]  0.3285 -0.761  0.5608  0.6100</span></span>
<span><span class="co">#&gt; [5,] -0.3432 -2.438 -0.5860 -0.6374</span></span>
<span><span class="co">#&gt; [6,]  0.1528 -1.200  0.2608  0.2837</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="making-a-parafac-model">Making a PARAFAC model<a class="anchor" aria-label="anchor" href="#making-a-parafac-model"></a>
</h3>
<p>The processed data is ready to be modelled using Parallel Factor
Analysis. Here we arbitrarily set the number of factors (i.e. the number
of components) to be three. This is normally the outcome of a more
detailed investigation into the correct number of components, described
in <code><a href="../articles/Fujita2023_analysis.html">vignette("Fujita2023_analysis")</a></code>,
<code><a href="../articles/Shao2019_analysis.html">vignette("Shao2019_analysis")</a></code> and
<code><a href="../articles/vanderPloeg2024_analysis.html">vignette("vanderPloeg2024_analysis")</a></code>. The output of the
function is a parafac object containing the loadings in each mode and
some statistics like R-squared and the sum of squared error.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="co"># for reproducibility</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="../reference/parafac.html">parafac</a></span><span class="op">(</span><span class="va">processedFujita</span><span class="op">$</span><span class="va">data</span>, nfac<span class="op">=</span><span class="fl">3</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,] -264.3 -116  363</span></span>
<span><span class="co">#&gt; [2,]  -85.3 -223  350</span></span>
<span><span class="co">#&gt; [3,] 1151.4 -196  431</span></span>
<span><span class="co">#&gt; [4,] -207.6 1549 -935</span></span>
<span><span class="co">#&gt; [5,] -101.9 -165  115</span></span>
<span><span class="co">#&gt; [6,]  -91.9  -98  111</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         [,1]    [,2]    [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.05013  0.0538  0.0659</span></span>
<span><span class="co">#&gt; [2,] 0.01393  0.0375 -0.1227</span></span>
<span><span class="co">#&gt; [3,] 0.00925 -0.1197 -0.0283</span></span>
<span><span class="co">#&gt; [4,] 0.01035 -0.1292 -0.0192</span></span>
<span><span class="co">#&gt; [5,] 0.01339 -0.0419  0.1130</span></span>
<span><span class="co">#&gt; [6,] 0.02418  0.0308 -0.1232</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;         [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] -0.0123 -5.16e-04  4.42e-04</span></span>
<span><span class="co">#&gt; [2,] -0.0142 -7.40e-04 -2.10e-03</span></span>
<span><span class="co">#&gt; [3,] -0.0134 -1.63e-03  7.54e-05</span></span>
<span><span class="co">#&gt; [4,] -0.0131 -5.58e-04 -1.70e-03</span></span>
<span><span class="co">#&gt; [5,] -0.0122 -6.15e-05 -7.12e-04</span></span>
<span><span class="co">#&gt; [6,] -0.0124 -1.47e-04 -8.95e-04</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">varExp</span></span>
<span><span class="co">#&gt; [1] 39</span></span></code></pre></div>
<p>This model explains 38.991 percent of the variation in the processed
data cube.</p>
</div>
<div class="section level3">
<h3 id="plotting-a-parafac-model">Plotting a PARAFAC model<a class="anchor" aria-label="anchor" href="#plotting-a-parafac-model"></a>
</h3>
<p>We have implemented the <code><a href="../reference/plotPARAFACmodel.html">plotPARAFACmodel()</a></code> function to
allow the user full control over how they want to visualize their model.
As such, there are a lot of plotting options that can be used, which you
can see below. A brief overview:</p>
<ul>
<li>colourCols: per mode (subject, feature, time), specifies by what
variable the loading bar plot should be coloured.</li>
<li>legendTitles: titles of the legends per mode, if colourCode is not
specified for a mode, a legend will not be generated.</li>
<li>xLabels: labels for the x axis of each mode.</li>
<li>legendColNums: the number of columns in the legend for each mode. If
colourCode is not specified for a mode, a legend will not be
generated.</li>
<li>arrangeModes: a vector of boolean values specifying if the loadings
should be grouped by their colourCol for easier inspection.</li>
<li>continuousModes: a vector of boolean values specifying if the
loadings should be visualized with a line plot instead of the default
bar plot.</li>
<li>overallTitle: title of the plot.</li>
</ul>
<p>For a full overview, please refer to the documentation of
<code><a href="../reference/plotPARAFACmodel.html">plotPARAFACmodel()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotPARAFACmodel.html">plotPARAFACmodel</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span>, <span class="va">processedFujita</span>,</span>
<span>  numComponents <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  colourCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Genus"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  legendTitles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Genus"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>  xLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Replicate"</span>, <span class="st">"Feature index"</span>, <span class="st">"Time point"</span><span class="op">)</span>,</span>
<span>  legendColNums <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>  arrangeModes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  continuousModes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  overallTitle <span class="op">=</span> <span class="st">"Fujita PARAFAC model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="PARAFAC_introduction_files/figure-html/plotting-1.png" width="1152"></p>
<p>This concludes the introduction to the
<code>parafac4microbiome</code> package. We hope this gives you
sufficient information to get started. For more details on modelling
specific datasets, please refer to
<code><a href="../articles/Fujita2023_analysis.html">vignette("Fujita2023_analysis")</a></code>,
<code><a href="../articles/Shao2019_analysis.html">vignette("Shao2019_analysis")</a></code> and
<code><a href="../articles/vanderPloeg2024_analysis.html">vignette("vanderPloeg2024_analysis")</a></code></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Geert Roelof van der Ploeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
