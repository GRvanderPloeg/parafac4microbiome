<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Parallel Factor Analysis Modelling of Longitudinal Microbiome Data â€¢ parafac4microbiome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Parallel Factor Analysis Modelling of Longitudinal Microbiome Data">
<meta name="description" content="Creation and selection of PARAllel FACtor Analysis (PARAFAC) models of longitudinal microbiome data. You can import your own data with our import functions or use one of the example datasets to create your own PARAFAC models. Selection of the optimal number of components can be done using assessModelQuality() and assessModelStability(). The selected model can then be plotted using plotPARAFACmodel(). The Parallel Factor Analysis method was originally described by Caroll and Chang (1970) &lt;doi:10.1007/BF02310791&gt; and Harshman (1970) &lt;https://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf&gt;.">
<meta property="og:description" content="Creation and selection of PARAllel FACtor Analysis (PARAFAC) models of longitudinal microbiome data. You can import your own data with our import functions or use one of the example datasets to create your own PARAFAC models. Selection of the optimal number of components can be done using assessModelQuality() and assessModelStability(). The selected model can then be plotted using plotPARAFACmodel(). The Parallel Factor Analysis method was originally described by Caroll and Chang (1970) &lt;doi:10.1007/BF02310791&gt; and Harshman (1970) &lt;https://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf&gt;.">
<meta property="og:image" content="https://grvanderploeg.github.io/parafac4microbiome/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">parafac4microbiome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Fujita2023_analysis.html">Fujita2023_analysis</a></li>
    <li><a class="dropdown-item" href="articles/PARAFAC_introduction.html">Introduction to PARAFAC modelling</a></li>
    <li><a class="dropdown-item" href="articles/Shao2019_analysis.html">Shao2019_analysis</a></li>
    <li><a class="dropdown-item" href="articles/vanderPloeg2024_analysis.html">vanderPloeg2024_analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GRvanderPloeg/parafac4microbiome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="parafac4microbiome-">parafac4microbiome 
<a class="anchor" aria-label="anchor" href="#parafac4microbiome-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>parafac4microbiome</code> package enables R users with an easy way to create Parallel Factor Analysis (PARAFAC) models for longitudinal microbiome data.</p>
<ul>
<li>
<code><a href="reference/processDataCube.html">processDataCube()</a></code> can be used to process the microbiome count data appropriately for a multi-way data array.</li>
<li>
<code><a href="reference/parafac.html">parafac()</a></code> allows the user to create a Parallel Factor Analysis model of the multi-way data array.</li>
<li>
<code><a href="reference/assessModelQuality.html">assessModelQuality()</a></code> helps the user select the appropriate number of components by randomly initializing many PARAFAC models and inspecting various metrics of interest.</li>
<li>
<code><a href="reference/assessModelStability.html">assessModelStability()</a></code> helps the user select the appropriate number of components by bootstrapping or jack-knifing samples and inspecting if the model outcome is similar.</li>
<li>
<code><a href="reference/plotPARAFACmodel.html">plotPARAFACmodel()</a></code> helps visually inspect the PARAFAC model.</li>
</ul>
<p>This package also comes with three example datasets.</p>
<ul>
<li>
<code>Fujita2023</code>: an in-vitro experiment of ocean inocula on peptide medium, sampled every day for 110 days (<a href="doi:10.1186/s40168-023-01474-5" class="uri">doi:10.1186/s40168-023-01474-5</a>).</li>
<li>
<code>Shao2019</code>: a large cohort dataset of vaginally and caesarean-section born infants from London (<a href="doi:10.1038/s41586-019-1560-1" class="uri">doi:10.1038/s41586-019-1560-1</a>).</li>
<li>
<code>vanderPloeg2024</code>: a small gingivitis intervention dataset with specific response groups (<a href="doi:10.1101/2024.03.18.585469" class="uri">doi:10.1101/2024.03.18.585469</a>).</li>
</ul>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>A basic introduction to the package is given in <code><a href="articles/PARAFAC_introduction.html">vignette("PARAFAC_introduction")</a></code> and modelling the example datasets are elaborated in their respective vignettes <code><a href="articles/Fujita2023_analysis.html">vignette("Fujita2023_analysis")</a></code>, <code><a href="articles/Shao2019_analysis.html">vignette("Shao2019_analysis")</a></code> and <code><a href="articles/vanderPloeg2024_analysis.html">vignette("vanderPloeg2024_analysis")</a></code>.</p>
<p>These vignettes and all function documentation can be found on the GitHub pages website <a href="https://grvanderploeg.github.io/parafac4microbiome/">here</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The <code>parafac4microbiome</code> package can be installed from CRAN using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"parafac4microbiome"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="development-version">Development version<a class="anchor" aria-label="anchor" href="#development-version"></a>
</h2>
<p>You can install the development version of <code>parafac4microbiome</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"GRvanderPloeg/parafac4microbiome"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Please use the following citation when using this package:</p>
<ul>
<li>van der Ploeg, G. R., Westerhuis, J., Heintz-Buschart, A., &amp; Smilde, A. (2024). parafac4microbiome: Exploratory analysis of longitudinal microbiome data using Parallel Factor Analysis. bioRxiv, 2024-05.</li>
</ul>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grvanderploeg.github.io/parafac4microbiome/">parafac4microbiome</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Process the data cube</span></span>
<span><span class="va">processedFujita</span> <span class="op">=</span> <span class="fu"><a href="reference/processDataCube.html">processDataCube</a></span><span class="op">(</span><span class="va">Fujita2023</span>,</span>
<span>                                  sparsityThreshold<span class="op">=</span><span class="fl">0.99</span>,</span>
<span>                                  CLR<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                  centerMode<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                  scaleMode<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a PARAFAC model</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="reference/parafac.html">parafac</a></span><span class="op">(</span><span class="va">processedFujita</span><span class="op">$</span><span class="va">data</span>, nfac<span class="op">=</span><span class="fl">3</span>, nstart<span class="op">=</span><span class="fl">10</span>, output<span class="op">=</span><span class="st">"best"</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sign flip components to make figure interpretable and comparable to the paper.</span></span>
<span><span class="co"># This has no effect on the model or the fit.</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># sign flip mode 1 component 2</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># sign flip mode 2 component 1</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span> <span class="co"># sign flip mode 2 component 3</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">model</span><span class="op">$</span><span class="va">Fac</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>         <span class="co"># sign flip all of mode 3</span></span>
<span></span>
<span><span class="co"># Plot the PARAFAC model using some metadata</span></span>
<span><span class="fu"><a href="reference/plotPARAFACmodel.html">plotPARAFACmodel</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">Fac</span>, <span class="va">processedFujita</span>,</span>
<span>                 numComponents <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                 colourCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Genus"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>                 legendTitles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Genus"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>                 xLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Replicate"</span>, <span class="st">"Feature index"</span>, <span class="st">"Time point"</span><span class="op">)</span>,</span>
<span>                 legendColNums <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                 arrangeModes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                 continuousModes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 overallTitle <span class="op">=</span> <span class="st">"Fujita PARAFAC model"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-usage-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>If you encounter an unexpected error or a clear bug, please file an issue with a minimal reproducible example here on <a href="https://github.com/GRvanderPloeg/parafac4microbiome/issues" class="external-link">Github</a>. For questions or other types of feedback, feel free to send an email.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=parafac4microbiome" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/GRvanderPloeg/parafac4microbiome/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/GRvanderPloeg/parafac4microbiome/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing parafac4microbiome</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Geert Roelof van der Ploeg <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0007-5204-3386" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>University of Amsterdam <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.codecov.io/gh/GRvanderPloeg/parafac4microbiome?branch=master" class="external-link"><img src="https://codecov.io/gh/GRvanderPloeg/parafac4microbiome/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/GRvanderPloeg/parafac4microbiome/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/GRvanderPloeg/parafac4microbiome/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Geert Roelof van der Ploeg, University of Amsterdam.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
