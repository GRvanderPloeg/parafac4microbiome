[{"path":"https://grvanderploeg.github.io/parafac4microbiome/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 parafac4microbiome authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Fujita2023_analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Fujita2023_analysis","text":"vignette examine model Fujita2023 data detail.","code":"library(parafac4microbiome) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) library(ggpubr)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Fujita2023_analysis.html","id":"processing-the-data-cube","dir":"Articles","previous_headings":"","what":"Processing the data cube","title":"Fujita2023_analysis","text":"data cube Fujita2023$data contains unprocessed counts. function processDataCube() performs processing counts following steps: performs feature selection based sparsityThreshold setting. Sparsity defined fraction samples microbial abundance (ASV/OTU otherwise) zero. performs centered log-ratio transformation sample using compositions::clr() function pseudo-count one (features, prior selection based sparsity). centers scales three-way array. complex subject, refer paper Rasmus Bro Age Smilde. centering across subject mode, make subjects comparable within time point. Scaling within feature mode avoids PARAFAC model focussing features abnormally high variation. outcome processing new version dataset. Please refer documentation processDataCube() information.","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, CLR=TRUE, centerMode=1, scaleMode=2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Fujita2023_analysis.html","id":"determining-the-correct-number-of-components","dir":"Articles","previous_headings":"","what":"Determining the correct number of components","title":"Fujita2023_analysis","text":"critical aspect PARAFAC modelling determine correct number components. developed function assessNumComponents() purpose. give function new dataset specify minimum maximum number components investigate number randomly initialized models try number components. Note: vignette reflects minimum working example analysing dataset due computational limitations automatic vignette rendering. Hence, look 1-3 components 5 random initializations . settings ideal real datasets. Please refer documentation assessNumComponents() information. now inspect output plots interest Fujita2023. overview plots show can reach ~35% explained variation take 3 components. CORCONDIA models ~98.5, well minimum requirement 60. Based overview, either 2 3 components seems fine.   Tucker Congruence Coefficients show us similar loading vectors mode , various components. value >=0.85 described problematic literature. Neither two-component model, three-component model loadings overly similar .","code":"# Setup minNumComponents = 1 maxNumComponents = 3 numRepetitions = 5 # number of randomly initialized models numFolds = 8 # number of jack-knifed models ctol = 1e-6 maxit = 200 numCores= 1  # Plot settings colourCols = c(\"\", \"Genus\", \"\") legendTitles = c(\"\", \"Genus\", \"\") xLabels = c(\"Replicate\", \"Feature index\", \"Time point\") legendColNums = c(0,5,0) arrangeModes = c(FALSE, TRUE, FALSE) continuousModes = c(FALSE,FALSE,TRUE)  # Assess the metrics to determine the correct number of components qualityAssessment = assessModelQuality(processedFujita$data, minNumComponents, maxNumComponents, numRepetitions, ctol=ctol, maxit=maxit, numCores=numCores) qualityAssessment$plots$overview qualityAssessment$plots$TCC[[2]] qualityAssessment$plots$TCC[[3]]"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Fujita2023_analysis.html","id":"jack-knifed-models","dir":"Articles","previous_headings":"","what":"Jack-knifed models","title":"Fujita2023_analysis","text":"Next, investigate stability models jack-knifing samples. give us information choose 2 3 components.    two-component jack-knifed models, seems instability second component, mainly time mode. three-component models stability overall.","code":"stabilityAssessment = assessModelStability(processedFujita, minNumComponents=1, maxNumComponents=3, numFolds=numFolds, considerGroups=FALSE,                                            groupVariable=\"\", colourCols, legendTitles, xLabels, legendColNums, arrangeModes,                                            ctol=ctol, maxit=maxit, numCores=numCores) stabilityAssessment$modelPlots[[1]] stabilityAssessment$modelPlots[[2]] stabilityAssessment$modelPlots[[3]] stabilityAssessment$FMSplot"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Fujita2023_analysis.html","id":"model-selection","dir":"Articles","previous_headings":"","what":"Model selection","title":"Fujita2023_analysis","text":"decided three-component model appropriate Fujita2023 dataset. can now select one random initializations assessNumComponents() output final model. ’re going select random initialisation corresponded maximum amount variation explained three components. Finally, visualize model using plotPARAFACmodel().","code":"numComponents = 3 modelChoice = which(qualityAssessment$metrics$varExp[,numComponents] == max(qualityAssessment$metrics$varExp[,numComponents])) finalModel = qualityAssessment$models[[numComponents]][[modelChoice]] plotPARAFACmodel(finalModel$Fac, processedFujita, 3, colourCols, legendTitles, xLabels, legendColNums, arrangeModes,   continuousModes = c(FALSE,FALSE,TRUE),   overallTitle = \"Fujita PARAFAC model\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/PARAFAC_introduction.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to PARAFAC modelling","text":"Welcome parafac4microbiome R package! vignette explain data available package, can model using PARAFAC plot outcome. require following packages dependencies.","code":"library(parafac4microbiome) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/PARAFAC_introduction.html","id":"datasets","dir":"Articles","previous_headings":"","what":"Datasets","title":"Introduction to PARAFAC modelling","text":"parafac4microbiome package comes three datasets: Fujita2023, Shao2019 vanderPloeg2024. refer first authors respective papers. dataset objects lists following contents: data: data cube microbiome counts. mode1: metadata corresponding subject mode. mode2: metadata corresponding feature (microbial abundances) mode. mode3: metadata corresponding time mode. briefly show data datasets look like focus Fujita2023 remainder vignette. details datasets refer parafac4microbiome paper original papers listed respective help files. Modelling component selection explained detail vignettes corresponding dataset: vignette(\"Fujita2023_analysis\"), vignette(\"Shao2019_analysis\") vignette(\"vanderPloeg2024_analysis\").","code":"dim(Fujita2023$data) #> [1]   8  28 110 dim(Shao2019$data) #> [1] 395 959   4 dim(vanderPloeg2024$data) #> [1]   41 2253    7  # We focus on Fujita2023 head(Fujita2023$data[,,1]) #>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] #> [1,] 11932    0    0    0    0    0    0    0    0   113     0   161     0 #> [2,] 11532    0    0    0    0    0    0    0    0     0     0     0     0 #> [3,] 10331    0    0    0    0    0    0    0    0   236     0     0  1824 #> [4,] 11528    0    0    0    0    0    0    0    0     0     0     0     0 #> [5,] 13735    0    0    0    0    0    0    0    0   139     0     0     0 #> [6,]  9167    0    0    0    0    0    0    0    0   247     0     0     0 #>      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] #> [1,]     0     0     0     0     0   719     0     0     0     0     0   230 #> [2,]     0     0     0     0     0     0     0    38     0     0     0     0 #> [3,]     0     0     0     0     0     0     0     0     0     0   162     0 #> [4,]     0     0     0     0     0     0     0     0     0     0     0     0 #> [5,]   217     0     0     0     0   239     0     0    67     0     0     0 #> [6,]     0     0     0     0     0     0     0     0     0     0     0     0 #>      [,26] [,27] [,28] #> [1,]     0     0     0 #> [2,]     0     0   231 #> [3,]     0     0     0 #> [4,]     0     0     0 #> [5,]     0     0     0 #> [6,]     0     0     0 head(Fujita2023$mode1) #> # A tibble: 6 × 1 #>   replicate.id #>          <int> #> 1            1 #> 2            2 #> 3            3 #> 4            4 #> 5            5 #> 6            6 head(Fujita2023$mode2) #>       ID  Kingdom         Phylum               Class #> 1 X_0002 Bacteria Proteobacteria Gammaproteobacteria #> 2 X_0004 Bacteria     Firmicutes          Clostridia #> 3 X_0007 Bacteria Proteobacteria Gammaproteobacteria #> 4 X_0008 Bacteria Proteobacteria Gammaproteobacteria #> 5 X_0010 Bacteria Proteobacteria Gammaproteobacteria #> 6 X_0015 Bacteria     Firmicutes          Clostridia #>                                 Order                Family #> 1                       Aeromonadales        Aeromonadaceae #> 2 Peptostreptococcales-Tissierellales Peptostreptococcaceae #> 3                     Burkholderiales      Burkholderiaceae #> 4                     Burkholderiales      Burkholderiaceae #> 5                    Enterobacterales          unidentified #> 6                      Lachnospirales       Lachnospiraceae #>                                        Genus      Species #> 1                                  Aeromonas unidentified #> 2                             Clostridioides   mangenotii #> 3                                  Pandoraea unidentified #> 4 Burkholderia-Caballeronia-Paraburkholderia unidentified #> 5                               unidentified unidentified #> 6                          Lachnoclostridium unidentified head(Fujita2023$mode3) #> # A tibble: 6 × 1 #>    time #>   <dbl> #> 1     1 #> 2     2 #> 3     3 #> 4     4 #> 5     5 #> 6     6"},{"path":[]},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/PARAFAC_introduction.html","id":"processing-the-data-cube","dir":"Articles","previous_headings":"Analysis","what":"Processing the data cube","title":"Introduction to PARAFAC modelling","text":"shown , data cube Fujita2023$data contains unprocessed counts. function processDataCube() performs processing counts following steps: performs feature selection based sparsityThreshold setting. Sparsity defined fraction samples microbial abundance (ASV/OTU otherwise) zero. performs centered log-ratio transformation sample using compositions::clr() function pseudo-count one (features, prior selection based sparsity). centers scales three-way array. complex subject, refer paper Rasmus Bro Age Smilde. centering across subject mode, make subjects comparable within time point. Scaling within feature mode avoids PARAFAC model focussing features abnormally high variation. outcome processing new version dataset. Please refer documentation processDataCube() information.","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, CLR=TRUE, centerMode=1, scaleMode=2) head(processedFujita$data[,,1]) #>         [,1]   [,2]    [,3]    [,4]    [,5]   [,6]    [,7]    [,8]   [,9] #> [1,] -0.5098 -0.265 -0.2669 -0.2743 -0.3655 -0.562 -0.2923 -0.5410 -0.890 #> [2,]  0.0763  0.017  0.0171  0.0176  0.0234  0.036  0.0187  0.0346  0.057 #> [3,] -0.5155 -0.179 -0.1797 -0.1847 -0.2461 -0.378 -0.1969 -0.3644 -0.600 #> [4,]  0.5277  0.218  0.2197  0.2258  0.3008  0.462  0.2406  0.4454  0.733 #> [5,] -0.2311 -0.228 -0.2296 -0.2359 -0.3144 -0.483 -0.2514 -0.4653 -0.766 #> [6,] -0.0526  0.102  0.1022  0.1050  0.1399  0.215  0.1119  0.2071  0.341 #>       [,10]  [,11]  [,12]  [,13]  [,14]   [,15]   [,16] [,17]   [,18]  [,19] #> [1,]  0.544 -0.862 -1.703 -0.495 -0.672 -0.4608 -0.2023  9.04 -0.9420 -1.199 #> [2,] -0.805 -0.575 -0.998 -0.272  0.043  0.0295  0.0130 -2.88  0.0603  4.373 #> [3,]  0.818  3.962 -1.487 -0.427 -0.453 -0.3104 -0.1363 -3.50 -0.6344 -1.010 #> [4,] -0.703 -0.369 -0.495 -0.114  0.553  0.3793  0.1666 -2.25  0.7754 -0.142 #> [5,]  0.627 -0.824  6.713 -0.466 -0.578 -0.3964 -0.1740  7.02 -0.8102 -1.118 #> [6,]  0.975 -0.488 -0.787 -0.206  0.257  0.1764  0.0775 -2.62  0.3607 -0.398 #>        [,20]  [,21]   [,22]   [,23] #> [1,] -0.3990 10.070 -0.6812 -0.7411 #> [2,]  0.0255 -1.517  0.0436  0.0474 #> [3,] -0.2687 -2.252 -0.4588 -0.4991 #> [4,]  0.3285 -0.761  0.5608  0.6100 #> [5,] -0.3432 -2.438 -0.5860 -0.6374 #> [6,]  0.1528 -1.200  0.2608  0.2837"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/PARAFAC_introduction.html","id":"making-a-parafac-model","dir":"Articles","previous_headings":"Analysis","what":"Making a PARAFAC model","title":"Introduction to PARAFAC modelling","text":"processed data ready modelled using Parallel Factor Analysis. arbitrarily set number factors (.e. number components) three. normally outcome detailed investigation correct number components, described vignette(\"Fujita2023_analysis\"), vignette(\"Shao2019_analysis\") vignette(\"vanderPloeg2024_analysis\"). output function parafac object containing loadings mode statistics like R-squared sum squared error. model explains 38.991 percent variation processed data cube.","code":"set.seed(0) # for reproducibility model = parafac(processedFujita$data, nfac=3, verbose=FALSE)  head(model$Fac[[1]]) #>        [,1] [,2] [,3] #> [1,] -264.3 -116  363 #> [2,]  -85.3 -223  350 #> [3,] 1151.4 -196  431 #> [4,] -207.6 1549 -935 #> [5,] -101.9 -165  115 #> [6,]  -91.9  -98  111 head(model$Fac[[2]]) #>         [,1]    [,2]    [,3] #> [1,] 0.05013  0.0538  0.0659 #> [2,] 0.01393  0.0375 -0.1227 #> [3,] 0.00925 -0.1197 -0.0283 #> [4,] 0.01035 -0.1292 -0.0192 #> [5,] 0.01339 -0.0419  0.1130 #> [6,] 0.02418  0.0308 -0.1232 head(model$Fac[[3]]) #>         [,1]      [,2]      [,3] #> [1,] -0.0123 -5.16e-04  4.42e-04 #> [2,] -0.0142 -7.40e-04 -2.10e-03 #> [3,] -0.0134 -1.63e-03  7.54e-05 #> [4,] -0.0131 -5.58e-04 -1.70e-03 #> [5,] -0.0122 -6.15e-05 -7.12e-04 #> [6,] -0.0124 -1.47e-04 -8.95e-04 model$varExp #> [1] 39"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/PARAFAC_introduction.html","id":"plotting-a-parafac-model","dir":"Articles","previous_headings":"Analysis","what":"Plotting a PARAFAC model","title":"Introduction to PARAFAC modelling","text":"implemented plotPARAFACmodel() function allow user full control want visualize model. , lot plotting options can used, can see . brief overview: colourCols: per mode (subject, feature, time), specifies variable loading bar plot coloured. legendTitles: titles legends per mode, colourCode specified mode, legend generated. xLabels: labels x axis mode. legendColNums: number columns legend mode. colourCode specified mode, legend generated. arrangeModes: vector boolean values specifying loadings grouped colourCol easier inspection. continuousModes: vector boolean values specifying loadings visualized line plot instead default bar plot. overallTitle: title plot. full overview, please refer documentation plotPARAFACmodel().  concludes introduction parafac4microbiome package. hope gives sufficient information get started. details modelling specific datasets, please refer vignette(\"Fujita2023_analysis\"), vignette(\"Shao2019_analysis\") vignette(\"vanderPloeg2024_analysis\")","code":"plotPARAFACmodel(model$Fac, processedFujita,   numComponents = 3,   colourCols = c(\"\", \"Genus\", \"\"),   legendTitles = c(\"\", \"Genus\", \"\"),   xLabels = c(\"Replicate\", \"Feature index\", \"Time point\"),   legendColNums = c(0,5,0),   arrangeModes = c(FALSE, TRUE, FALSE),   continuousModes = c(FALSE,FALSE,TRUE),   overallTitle = \"Fujita PARAFAC model\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Shao2019_analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Shao2019_analysis","text":"vignette examine model Shao2019 data detail.","code":"library(parafac4microbiome) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) library(ggpubr)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Shao2019_analysis.html","id":"processing-the-data-cube","dir":"Articles","previous_headings":"","what":"Processing the data cube","title":"Shao2019_analysis","text":"data cube Shao2019$data contains unprocessed counts. function processDataCube() performs processing counts following steps: performs feature selection based sparsityThreshold setting. Sparsity defined fraction samples microbial abundance (ASV/OTU otherwise) zero. Shao2019 can take delivery mode groups account feature selection. calculating sparsity feature subject group compare sparsity threshold set. feature passes threshold either group, selected. performs centered log-ratio transformation sample using compositions::clr() function pseudo-count one (features, prior selection based sparsity). centers scales three-way array. complex subject, refer paper Rasmus Bro Age Smilde. centering across subject mode, make subjects comparable within time point. Scaling within feature mode avoids PARAFAC model focussing features abnormally high variation. outcome processing new version dataset. Please refer documentation processDataCube() information.","code":"processedShao = processDataCube(Shao2019, sparsityThreshold=0.9, considerGroups=TRUE, groupVariable=\"Delivery_mode\", CLR=TRUE, centerMode=1, scaleMode=2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Shao2019_analysis.html","id":"determining-the-correct-number-of-components","dir":"Articles","previous_headings":"","what":"Determining the correct number of components","title":"Shao2019_analysis","text":"critical aspect PARAFAC modelling determine correct number components. developed function assessNumComponents() purpose. give function new dataset specify minimum maximum number components investigate number randomly initialized models try number components. Note: vignette reflects minimum working example analysing dataset due computational limitations. Hence, look 1-3 components 5 random initializations . settings ideal real datasets. Please refer documentation assessNumComponents() information. now inspect output plots interest Shao2019. overview plots shows can explain ~17% variation three-component model. quite low. CORCONDIA number components ~99.8 higher, well minimum requirement 60.   Tucker Congruence Coefficients show us similar loading vectors mode , various components. value >=0.85 described problematic literature. Neither two-component model, three-component model loadings similar .","code":"# Setup # For computational purposes we deviate from the default settings minNumComponents = 1 maxNumComponents = 3 numRepetitions = 5 # number of randomly initialized models numFolds = 5 # number of jack-knifed models maxit = 200 ctol= 1e-6 #1e-4 this is a really bad setting but is needed to save computational time numCores = 1  colourCols = c(\"Delivery_mode\", \"phylum\", \"\") legendTitles = c(\"Delivery mode\", \"Phylum\", \"\") xLabels = c(\"Subject index\", \"Feature index\", \"Time index\") legendColNums = c(3,5,0) arrangeModes = c(TRUE, TRUE, FALSE) continuousModes = c(FALSE,FALSE,TRUE)  # Assess the metrics to determine the correct number of components qualityAssessment = assessModelQuality(processedShao$data, minNumComponents, maxNumComponents, numRepetitions, ctol=ctol, maxit=maxit, numCores=numCores) qualityAssessment$plots$overview qualityAssessment$plots$TCC[[2]] qualityAssessment$plots$TCC[[3]]"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Shao2019_analysis.html","id":"jack-knifed-models","dir":"Articles","previous_headings":"","what":"Jack-knifed models","title":"Shao2019_analysis","text":"Next, investigate stability models jack-knifing samples. give us information choose 2 3 components.    models quite unstable. models likely need iterations strict tolerance converge properly (see documentation assessNumComponents() modelStabilityCheck() info). simplicity’s sake select two components , refer parafac4microbiome paper outcome rigorous check performed.","code":"stabilityAssessment = assessModelStability(processedShao, minNumComponents=1, maxNumComponents=3, numFolds=numFolds, considerGroups=TRUE,                                            groupVariable=\"Delivery_mode\", colourCols, legendTitles, xLabels, legendColNums, arrangeModes,                                            ctol=ctol, maxit=maxit, numCores=numCores)  stabilityAssessment$modelPlots[[1]] stabilityAssessment$modelPlots[[2]] stabilityAssessment$modelPlots[[3]] stabilityAssessment$FMSplot"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/Shao2019_analysis.html","id":"model-selection","dir":"Articles","previous_headings":"","what":"Model selection","title":"Shao2019_analysis","text":"decided two-component model appropriate Shao2019 dataset. can now select one random initializations assessNumComponents() output final model. ’re going select random initialisation corresponded maximum amount variation explained two components. Finally, visualize model using plotPARAFACmodel().","code":"numComponents = 2 modelChoice = which(qualityAssessment$metrics$varExp[,numComponents] == max(qualityAssessment$metrics$varExp[,numComponents])) finalModel = qualityAssessment$models[[numComponents]][[modelChoice]] plotPARAFACmodel(finalModel$Fac, processedShao, 2, colourCols, legendTitles, xLabels, legendColNums, arrangeModes,   continuousModes = c(FALSE,FALSE,TRUE),   overallTitle = \"Shao PARAFAC model\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/vanderPloeg2024_analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"vanderPloeg2024_analysis","text":"vignette examine model vanderPloeg2024 data detail.","code":"library(parafac4microbiome) library(dplyr) #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ggplot2) library(ggpubr)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/vanderPloeg2024_analysis.html","id":"processing-the-data-cube","dir":"Articles","previous_headings":"","what":"Processing the data cube","title":"vanderPloeg2024_analysis","text":"data cube vanderPloeg2024$data contains unprocessed counts. function processDataCube() performs processing counts following steps: performs feature selection based sparsityThreshold setting. Sparsity defined fraction samples microbial abundance (ASV/OTU otherwise) zero. vanderPloeg2024 can take RFgroups groups account feature selection. calculating sparsity feature subject group compare sparsity threshold set. feature passes threshold either group, selected. performs centered log-ratio transformation sample using compositions::clr() function pseudo-count one (features, prior selection based sparsity). centers scales three-way array. complex subject, refer paper Rasmus Bro Age Smilde. centering across subject mode, make subjects comparable within time point. Scaling within feature mode avoids PARAFAC model focussing features abnormally high variation. outcome processing new version dataset. Please refer documentation processDataCube() information.","code":"processedPloeg = processDataCube(vanderPloeg2024, sparsityThreshold=0.50, considerGroups=TRUE, groupVariable=\"RFgroup\", CLR=TRUE, centerMode=1, scaleMode=2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/vanderPloeg2024_analysis.html","id":"determining-the-correct-number-of-components","dir":"Articles","previous_headings":"","what":"Determining the correct number of components","title":"vanderPloeg2024_analysis","text":"critical aspect PARAFAC modelling determine correct number components. developed function assessNumComponents() purpose. give function new dataset specify minimum maximum number components investigate number randomly initialized models try number components. Note: vignette reflects minimum working example analysing dataset due computational limitations. Hence, look 1-3 components 5 random initializations . settings ideal real datasets. Please refer documentation assessNumComponents() information. now inspect output plots interest vanderPloeg2024. seems clear-cut case two-component model, three-component models CORCONDIA -600. maximum amount variation can describe ~20%.  Tucker Congruence Coefficients show us similar loading vectors mode , various components. value >=0.85 described problematic literature. confirm already observed CORCONDIA metric: loadings feature time mode three-component model highly similar . Hence must select two-component model.","code":"# Setup # For computational purposes we deviate from the default settings minNumComponents = 1 maxNumComponents = 3 numRepetitions = 5 # number of randomly initialized models numFolds = 5 # number of jack-knifed models ctol = 1e-6 maxit = 250 numCores = 1  colourCols = c(\"RFgroup\", \"Phylum\", \"\") legendTitles = c(\"RF group\", \"Phylum\", \"\") xLabels = c(\"Subject index\", \"Feature index\", \"Time index\") legendColNums = c(3,5,0) arrangeModes = c(TRUE, TRUE, FALSE) continuousModes = c(FALSE,FALSE,TRUE)  # Assess the metrics to determine the correct number of components qualityAssessment = assessModelQuality(processedPloeg$data, minNumComponents, maxNumComponents, numRepetitions, ctol=ctol, maxit=maxit, numCores=numCores) qualityAssessment$plots$overview qualityAssessment$plots$TCC[[2]] qualityAssessment$plots$TCC[[3]]"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/vanderPloeg2024_analysis.html","id":"jack-knifed-models","dir":"Articles","previous_headings":"","what":"Jack-knifed models","title":"vanderPloeg2024_analysis","text":"Next, investigate stability models jack-knifing samples. briefly inspect two-component three-component cases although already know appropriate data.     two-component models stable. three-component models indeed show similar time profiles also instability.","code":"stabilityAssessment = assessModelStability(processedPloeg, minNumComponents=1, maxNumComponents=3, numFolds=numFolds, considerGroups=TRUE,                                            groupVariable=\"Delivery_mode\", colourCols, legendTitles, xLabels, legendColNums, arrangeModes,                                            ctol=ctol, maxit=maxit, numCores=numCores)  stabilityAssessment$modelPlots[[1]] stabilityAssessment$modelPlots[[2]] stabilityAssessment$modelPlots[[3]] stabilityAssessment$FMSplot"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/articles/vanderPloeg2024_analysis.html","id":"model-selection","dir":"Articles","previous_headings":"","what":"Model selection","title":"vanderPloeg2024_analysis","text":"decided two-component model appropriate vanderPloeg2024 dataset. can now select one random initializations assessNumComponents() output final model. ’re going select random initialisation corresponded maximum amount variation explained two components. Finally, visualize model using plotPARAFACmodel().","code":"numComponents = 2 modelChoice = which(qualityAssessment$metrics$varExp[,numComponents] == max(qualityAssessment$metrics$varExp[,numComponents])) finalModel = qualityAssessment$models[[numComponents]][[modelChoice]] plotPARAFACmodel(finalModel$Fac, processedPloeg, 2, colourCols, legendTitles, xLabels, legendColNums, arrangeModes, continuousModes,   overallTitle = \"vanderPloeg2024 PARAFAC model\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Geert Roelof van der Ploeg. Author, maintainer.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"van der Ploeg G (2024). parafac4microbiome: Parallel Factor Analysis modelling longitudinal microbiome data. R package version 0.0.2, https://grvanderploeg.github.io/parafac4microbiome/.","code":"@Manual{,   title = {parafac4microbiome: Parallel Factor Analysis modelling for longitudinal microbiome data},   author = {Geert Roelof {van der Ploeg}},   year = {2024},   note = {R package version 0.0.2},   url = {https://grvanderploeg.github.io/parafac4microbiome/}, }"},{"path":[]},{"path":"https://grvanderploeg.github.io/parafac4microbiome/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Parallel Factor Analysis modelling for longitudinal microbiome data","text":"parafac4microbiome package enables R users easy way create Parallel Factor Analysis (PARAFAC) models longitudinal microbiome data. processDataCube() can used process microbiome count data appropriately multi-way data array. parafac() allows user create Parallel Factor Analysis model multi-way data array. assessModelQuality() helps user select appropriate number components randomly initializing many PARAFAC models inspecting various metrics interest. assessModelStability() helps user select appropriate number components bootstrapping jack-knifing samples inspecting model outcome similar. plotPARAFACmodel() helps visually inspect PARAFAC model. package also comes three example datasets. Fujita2023: -vitro experiment ocean inocula peptide medium, sampled every day 110 days (https://doi.org/10.1186/s40168-023-01474-5). Shao2019: large cohort dataset vaginally caesarean-section born infants London (https://www.nature.com/articles/s41586-019-1560-1). vanderPloeg2024: small gingivitis intervention dataset specific response groups (https://doi.org/10.1101/2024.03.18.585469).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Parallel Factor Analysis modelling for longitudinal microbiome data","text":"basic introduction package given vignette(\"PARAFAC_introduction\") modelling example datasets elaborated respective vignettes vignette(\"Fujita2023_analysis\"), vignette(\"Shao2019_analysis\") vignette(\"vanderPloeg2024_analysis\"). vignettes function documentation can found GitHub pages website .","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Parallel Factor Analysis modelling for longitudinal microbiome data","text":"can install development version parafac4microbiome GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"GRvanderPloeg/parafac4microbiome\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Parallel Factor Analysis modelling for longitudinal microbiome data","text":"Please use following citation using package: van der Ploeg, G.R., et al. (2024). parafac4microbiome: Exploratory analysis longitudinal microbiome data using Parallel Factor Analysis [Manuscript preparation].","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Parallel Factor Analysis modelling for longitudinal microbiome data","text":"","code":"library(parafac4microbiome) set.seed(0) # for reproducibility  # Process the data cube processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, CLR=TRUE, centerMode=1, scaleMode=2)  # Make a PARAFAC model model = parafac(processedFujita$data, nfac=3, verbose=FALSE)  # Plot the PARAFAC model using some metadata plotPARAFACmodel(model$Fac, processedFujita,                  numComponents = 3,                  colourCols = c(\"\", \"Genus\", \"\"),                  legendTitles = c(\"\", \"Genus\", \"\"),                  xLabels = c(\"Replicate\", \"Feature index\", \"Time point\"),                  legendColNums = c(0,5,0),                  arrangeModes = c(FALSE, TRUE, FALSE),                  continuousModes = c(FALSE,FALSE,TRUE),                  overallTitle = \"Fujita PARAFAC model\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Fujita2023.html","id":null,"dir":"Reference","previous_headings":"","what":"Fujita2023 longitudinal microbiome data — Fujita2023","title":"Fujita2023 longitudinal microbiome data — Fujita2023","text":"Fujita2023 longitudinal microbiome dataset three-dimensional array, replicates mode 1, microbial abundances mode 2 time mode 3.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Fujita2023.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fujita2023 longitudinal microbiome data — Fujita2023","text":"","code":"Fujita2023"},{"path":[]},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Fujita2023.html","id":"fujita-","dir":"Reference","previous_headings":"","what":"Fujita2023","title":"Fujita2023 longitudinal microbiome data — Fujita2023","text":"list object three elements: data Array object data cube mode1 Dataframe subject metadata, ordered rows data cube. mode2 Taxonomic classification microbiota, ordered columns data cube. mode3 Dataframe time metadata, ordered third dimension array.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Fujita2023.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fujita2023 longitudinal microbiome data — Fujita2023","text":"https://doi.org/10.1186/s40168-023-01474-5","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Shao2019.html","id":null,"dir":"Reference","previous_headings":"","what":"Shao2019 longitudinal microbiome data — Shao2019","title":"Shao2019 longitudinal microbiome data — Shao2019","text":"Shao2019 longitudinal microbiome dataset three-dimensional array, subjects mode 1, microbial abundances mode 2 time mode 3. Note: time points 4, 7, 21 Infancy used. Note: -zero microbial abundances removed save disk space.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Shao2019.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shao2019 longitudinal microbiome data — Shao2019","text":"","code":"Shao2019"},{"path":[]},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Shao2019.html","id":"shao-","dir":"Reference","previous_headings":"","what":"Shao2019","title":"Shao2019 longitudinal microbiome data — Shao2019","text":"list object three elements: data Array object data cube mode1 Dataframe subject metadata, ordered rows data cube. mode2 Taxonomic classification microbiota, ordered columns data cube. mode3 Dataframe time metadata, ordered third dimension array.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/Shao2019.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Shao2019 longitudinal microbiome data — Shao2019","text":"https://doi.org/10.1038/s41586-019-1560-1","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelQuality.html","id":null,"dir":"Reference","previous_headings":"","what":"Create randomly initialized models to determine the correct number of components by assessing model quality metrics. — assessModelQuality","title":"Create randomly initialized models to determine the correct number of components by assessing model quality metrics. — assessModelQuality","text":"Create randomly initialized models determine correct number components assessing model quality metrics.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelQuality.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create randomly initialized models to determine the correct number of components by assessing model quality metrics. — assessModelQuality","text":"","code":"assessModelQuality(   X,   minNumComponents = 1,   maxNumComponents = 5,   numRepetitions = 100,   ctol = 1e-06,   maxit = 2500,   numCores = 1 )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelQuality.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create randomly initialized models to determine the correct number of components by assessing model quality metrics. — assessModelQuality","text":"X Input data minNumComponents Minimum number components (default 1). maxNumComponents Maximum number components (default 5). numRepetitions Number randomly initialized models create (default 100). ctol Change SSQ needed model converged (default 1e-6). maxit Maximum number iterations (default 2500). numCores Number cores use. set larger 1, run job parallel (default 1)","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelQuality.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create randomly initialized models to determine the correct number of components by assessing model quality metrics. — assessModelQuality","text":"list object following: plots: Plots assessed metrics overview plot showing summary . metrics: metrics every created model (number iterations, sum squared errors, CORCONDIA score variance explained). models: created models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelQuality.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create randomly initialized models to determine the correct number of components by assessing model quality metrics. — assessModelQuality","text":"","code":"X = Fujita2023$data assessment = assessModelQuality(X, minNumComponents=1, maxNumComponents=3, numRepetitions=5) assessment$plots$overview"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelStability.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrapping procedure to determine PARAFAC model stability for a given number of components. — assessModelStability","title":"Bootstrapping procedure to determine PARAFAC model stability for a given number of components. — assessModelStability","text":"Bootstrapping procedure determine PARAFAC model stability given number components.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelStability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrapping procedure to determine PARAFAC model stability for a given number of components. — assessModelStability","text":"","code":"assessModelStability(   dataset,   minNumComponents = 1,   maxNumComponents = 5,   numFolds = dim(dataset$data)[1],   considerGroups = FALSE,   groupVariable = \"\",   colourCols = NULL,   legendTitles = NULL,   xLabels = NULL,   legendColNums = NULL,   arrangeModes = NULL,   ctol = 1e-06,   maxit = 2500,   numCores = 1 )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelStability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrapping procedure to determine PARAFAC model stability for a given number of components. — assessModelStability","text":"dataset See Fujita2023, Shao2019 vanderPloeg2024. minNumComponents Minimum number components (default 1). maxNumComponents Maximum number components (default 5). numFolds Number bootstrapped models create. considerGroups Consider subject groups calculating sparsity (default FALSE) groupVariable Column name dataset$mode1 used consider groups (default \"\") colourCols Vector strings stating column names factorized colours per mode. legendTitles Vector strings stating legend title per mode. xLabels Vector strings stating x-axis labels per mode. legendColNums Vector integers stating desired number columns legends per mode. arrangeModes Vector boolean values per mode, stating loadings arranged according colourCols (TRUE) (FALSE). ctol Relative change loss tolerated call algorithm converged (default 1e-4). maxit Maximum number iterations allowed without convergence (default 500). numCores Number cores use. set larger 1, run job parallel (default 1)","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelStability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrapping procedure to determine PARAFAC model stability for a given number of components. — assessModelStability","text":"list containing following: models: stabilized sign-flipped bootstrapped PARAFAC models. modelPlots: list plots median model error bars number components. FMSplot: bar plot showing Factor Match Scores per number components (see Li et al., 2024). FMS: FMS values FMS plot based .","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/assessModelStability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bootstrapping procedure to determine PARAFAC model stability for a given number of components. — assessModelStability","text":"","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2) modelStability = assessModelStability(processedFujita, minNumComponents=1, maxNumComponents=3)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calcVarExpPerComponent.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the variance explained of a PARAFAC model, per component — calcVarExpPerComponent","title":"Calculate the variance explained of a PARAFAC model, per component — calcVarExpPerComponent","text":"Calculate variance explained PARAFAC model, per component","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calcVarExpPerComponent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the variance explained of a PARAFAC model, per component — calcVarExpPerComponent","text":"","code":"calcVarExpPerComponent(Fac, X)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calcVarExpPerComponent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the variance explained of a PARAFAC model, per component — calcVarExpPerComponent","text":"Fac Fac object output model X Input dataset","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calcVarExpPerComponent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the variance explained of a PARAFAC model, per component — calcVarExpPerComponent","text":"Vector scalars percentage variation explained per component","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calcVarExpPerComponent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the variance explained of a PARAFAC model, per component — calcVarExpPerComponent","text":"","code":"X = array(rnorm(108*100*10), c(108,100,10)) model = parafac(X, 2) calcVarExpPerComponent(model$Fac, X) #> [1] 0.3570396 0.3485468"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateFMS.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Factor Match Score for all initialized models. — calculateFMS","title":"Calculate Factor Match Score for all initialized models. — calculateFMS","text":"Calculate Factor Match Score initialized models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateFMS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Factor Match Score for all initialized models. — calculateFMS","text":"","code":"calculateFMS(models)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateFMS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Factor Match Score for all initialized models. — calculateFMS","text":"models Output parafac() using output=\"\".","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateFMS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Factor Match Score for all initialized models. — calculateFMS","text":"Vector containing FMS scores comparisons","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateFMS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Factor Match Score for all initialized models. — calculateFMS","text":"","code":"A = array(rnorm(108*2), c(108, 2)) B = array(rnorm(100*2), c(100, 2)) C = array(rnorm(10*2), c(10, 2)) X = reinflateTensor(A, B, C) models = parafac(X, 2, initialization=\"random\", nstart=10, maxit=2, output=\"all\") calculateFMS(models) #>  [1] 1.0000000 0.6192298 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 #>  [8] 1.0000000 0.6041323 0.6192285 1.0000000 1.0000000 1.0000000 1.0000000 #> [15] 1.0000000 1.0000000 0.6041336 0.6645001 0.6645015 0.6645007 0.6645008 #> [22] 0.6645012 0.6645004 0.2500259 1.0000000 1.0000000 1.0000000 1.0000000 #> [29] 1.0000000 0.6041333 1.0000000 1.0000000 1.0000000 1.0000000 0.6041328 #> [36] 1.0000000 1.0000000 1.0000000 0.6041330 1.0000000 1.0000000 0.6041323 #> [43] 1.0000000 0.6041325 0.6041330"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateSparsity.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate sparsity across the feature mode of a multi-way array. — calculateSparsity","title":"Calculate sparsity across the feature mode of a multi-way array. — calculateSparsity","text":"Calculate sparsity across feature mode multi-way array.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateSparsity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate sparsity across the feature mode of a multi-way array. — calculateSparsity","text":"","code":"calculateSparsity(dataset, considerGroups = FALSE, groupVariable = \"\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateSparsity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate sparsity across the feature mode of a multi-way array. — calculateSparsity","text":"dataset See Fujita2023, Shao2019 vanderPloeg2024. considerGroups Consider subject groups calculating sparsity (default FALSE) groupVariable Column name dataset$mode1 used consider groups (default \"\")","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateSparsity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate sparsity across the feature mode of a multi-way array. — calculateSparsity","text":"Vector sparsity fractions (N x J) N number groups J number features.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateSparsity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate sparsity across the feature mode of a multi-way array. — calculateSparsity","text":"","code":"# No groups sparsity = calculateSparsity(Fujita2023) length(sparsity) #> [1] 28 hist(sparsity)   # Consider groups colnames(Shao2019$mode1) #> [1] \"Individual\"    \"Delivery_mode\" sparsity = calculateSparsity(Shao2019, considerGroups=TRUE, groupVariable=\"Delivery_mode\") dim(sparsity) #> [1]   2 959 hist(sparsity[1,])  hist(sparsity[2,])"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateVarExp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the variation explained by a PARAFAC model. — calculateVarExp","title":"Calculate the variation explained by a PARAFAC model. — calculateVarExp","text":"Calculate variation explained PARAFAC model.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateVarExp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the variation explained by a PARAFAC model. — calculateVarExp","text":"","code":"calculateVarExp(Fac, X)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateVarExp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the variation explained by a PARAFAC model. — calculateVarExp","text":"Fac Fac object output parafac() function. X Input data PARAFAC model.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateVarExp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the variation explained by a PARAFAC model. — calculateVarExp","text":"variation explained model, expressed fraction (0-1).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/calculateVarExp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the variation explained by a PARAFAC model. — calculateVarExp","text":"","code":"X = Fujita2023$data model = parafac(X, nfac=1, nstart=1, verbose=FALSE) calculateVarExp(model$Fac, X) #> [1] 0.7372743"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/corcondia.html","id":null,"dir":"Reference","previous_headings":"","what":"Core Consistency Diagnostic (CORCONDIA) calculation — corcondia","title":"Core Consistency Diagnostic (CORCONDIA) calculation — corcondia","text":"Core Consistency Diagnostic (CORCONDIA) calculation","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/corcondia.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Core Consistency Diagnostic (CORCONDIA) calculation — corcondia","text":"","code":"corcondia(X, Fac)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/corcondia.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Core Consistency Diagnostic (CORCONDIA) calculation — corcondia","text":"X Input data matrix Fac PARAFAC model Fac object","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/corcondia.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Core Consistency Diagnostic (CORCONDIA) calculation — corcondia","text":"Scalar CORCONDIA value","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/corcondia.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Core Consistency Diagnostic (CORCONDIA) calculation — corcondia","text":"","code":"X = Fujita2023$data model = parafac(X, 2) corcondia(X, model$Fac) #> [1] -40.55863"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/flipLoadings.html","id":null,"dir":"Reference","previous_headings":"","what":"Sign flip the loadings of many randomly initialized models to make consistent overview plots. — flipLoadings","title":"Sign flip the loadings of many randomly initialized models to make consistent overview plots. — flipLoadings","text":"Sign flip loadings many randomly initialized models make consistent overview plots.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/flipLoadings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sign flip the loadings of many randomly initialized models to make consistent overview plots. — flipLoadings","text":"","code":"flipLoadings(models, X)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/flipLoadings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sign flip the loadings of many randomly initialized models to make consistent overview plots. — flipLoadings","text":"models Output parafac. X Input dataset parafac modelling procedure.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/flipLoadings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sign flip the loadings of many randomly initialized models to make consistent overview plots. — flipLoadings","text":"models sign flipped components applicable.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/flipLoadings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sign flip the loadings of many randomly initialized models to make consistent overview plots. — flipLoadings","text":"","code":"A = array(rnorm(108*2), c(108,2)) B = array(rnorm(100*2), c(100,2)) C = array(rnorm(10*2), c(10,2)) X = reinflateTensor(A, B, C) models = parafac(X, 2, nstart=10, output=\"all\", sortComponents=TRUE) flippedModels = flipLoadings(models, X)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/initializePARAFAC.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize PARAFAC algorithm input vectors — initializePARAFAC","title":"Initialize PARAFAC algorithm input vectors — initializePARAFAC","text":"Initialize PARAFAC algorithm input vectors","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/initializePARAFAC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize PARAFAC algorithm input vectors — initializePARAFAC","text":"","code":"initializePARAFAC(Tensor, nfac, initialization = \"random\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/initializePARAFAC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize PARAFAC algorithm input vectors — initializePARAFAC","text":"Tensor Input dataset matrix tensor nfac Number components initialize. initialization Either \"random\" random initialization \"svd\" svd based.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/initializePARAFAC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize PARAFAC algorithm input vectors — initializePARAFAC","text":"Fac object initialized components.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/initializePARAFAC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize PARAFAC algorithm input vectors — initializePARAFAC","text":"","code":"A = array(rnorm(108,2), c(108,2)) B = array(rnorm(100,2), c(100,2)) C = array(rnorm(10,2), c(10,2)) Tensor = reinflateTensor(A, B, C, returnAsTensor=TRUE) init = initializePARAFAC(Tensor, 2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCLR.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform a centered log-ratio transform over a multi-way array — multiwayCLR","title":"Perform a centered log-ratio transform over a multi-way array — multiwayCLR","text":"Note: Propagates NAs corresponding missing samples.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCLR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform a centered log-ratio transform over a multi-way array — multiwayCLR","text":"","code":"multiwayCLR(X, pseudocount = 1)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCLR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform a centered log-ratio transform over a multi-way array — multiwayCLR","text":"X Multi-way array counts pseudocount Pseudocount value use (default 1).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCLR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform a centered log-ratio transform over a multi-way array — multiwayCLR","text":"CLRed cube","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCLR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform a centered log-ratio transform over a multi-way array — multiwayCLR","text":"","code":"cubeCLR = multiwayCLR(Fujita2023$data)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCenter.html","id":null,"dir":"Reference","previous_headings":"","what":"Center a multi-way array — multiwayCenter","title":"Center a multi-way array — multiwayCenter","text":"Center multi-way array","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCenter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Center a multi-way array — multiwayCenter","text":"","code":"multiwayCenter(X, mode = 1)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCenter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Center a multi-way array — multiwayCenter","text":"X Multi-way array mode Mode center across (default 1).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCenter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Center a multi-way array — multiwayCenter","text":"Centered multi-way array","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayCenter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Center a multi-way array — multiwayCenter","text":"","code":"cube_cnt = multiwayCenter(Fujita2023$data)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayScale.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale a multi-way array — multiwayScale","title":"Scale a multi-way array — multiwayScale","text":"Scale multi-way array","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayScale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale a multi-way array — multiwayScale","text":"","code":"multiwayScale(X, mode = 2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayScale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale a multi-way array — multiwayScale","text":"X Multi-way array mode Mode scale within: 1=subjects,2=features,3=time (default 2).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayScale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale a multi-way array — multiwayScale","text":"Scaled multi-way array","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/multiwayScale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale a multi-way array — multiwayScale","text":"","code":"cube_scl = multiwayCenter(Fujita2023$data)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel Factor Analysis — parafac","title":"Parallel Factor Analysis — parafac","text":"Parallel Factor Analysis","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel Factor Analysis — parafac","text":"","code":"parafac(   Tensor,   nfac,   nstart = 1,   maxit = 500,   ctol = 1e-04,   initialization = \"random\",   verbose = FALSE,   output = \"best\",   sortComponents = FALSE )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel Factor Analysis — parafac","text":"Tensor 3-way matrix numeric data nfac Number factors (components) fit. nstart Number models randomly initialize (default 1). maxit Maximum number iterations allowed without convergence (default 500). ctol Relative change loss tolerated call algorithm converged (default 1e-4). initialization \"Random\" randomly initialized input vectors \"nvec\" svd-based best guess. verbose DEPRECATED: verbose output output String (\"best\"/\"\") Return best model nstart models (\"best\") return list object (\"\"). sortComponents Boolean sort components based variance explained (default FALSE)","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel Factor Analysis — parafac","text":"List object PARAFAC model models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parallel Factor Analysis — parafac","text":"","code":"X = array(rnorm(108*100*10), c(108,100,10)) model = parafac(X, 2)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_core_als.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal PARAFAC alternating least-squares (ALS) core algorithm — parafac_core_als","title":"Internal PARAFAC alternating least-squares (ALS) core algorithm — parafac_core_als","text":"Internal PARAFAC alternating least-squares (ALS) core algorithm","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_core_als.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal PARAFAC alternating least-squares (ALS) core algorithm — parafac_core_als","text":"","code":"parafac_core_als(Tensor, nfac, init, maxit = 500, ctol = 1e-04)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_core_als.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal PARAFAC alternating least-squares (ALS) core algorithm — parafac_core_als","text":"Tensor Tensor data object nfac Number components compute init Initialization initializePARAFAC. maxit Maximum number iterations run (default 500). ctol Loss function tolerance convergence (default 1e-4)","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_core_als.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal PARAFAC alternating least-squares (ALS) core algorithm — parafac_core_als","text":"List containing Fac object loss per iteration","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_core_als.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Internal PARAFAC alternating least-squares (ALS) core algorithm — parafac_core_als","text":"","code":"A = array(rnorm(108*2), c(108,2)) B = array(rnorm(100*2), c(100,2)) C = array(rnorm(10*2), c(10,2)) Tensor = reinflateTensor(A, B, C) init = initializePARAFAC(Tensor, 2) model = parafac_core_als(Tensor, 2, init)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"PARAFAC loss function calculation — parafac_fun","title":"PARAFAC loss function calculation — parafac_fun","text":"PARAFAC loss function calculation","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PARAFAC loss function calculation — parafac_fun","text":"","code":"parafac_fun(X, Fac, lambdas = NULL)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PARAFAC loss function calculation — parafac_fun","text":"X Input data Fac Fac object generated PARAFAC algorithm lambdas lambdas (kruskal tensor case) generated make Fac norm 1, can supplied.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PARAFAC loss function calculation — parafac_fun","text":"Scalar value loss function","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/parafac_fun.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PARAFAC loss function calculation — parafac_fun","text":"","code":"A = array(rnorm(108*2), c(108,2)) B = array(rnorm(100*2), c(100,2)) C = array(rnorm(10*2), c(10,2)) X = reinflateTensor(A, B, C) model = parafac(X, 2) f = parafac_fun(X, model$Fac)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelMetric.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics of many initialized PARAFAC models. — plotModelMetric","title":"Plot diagnostics of many initialized PARAFAC models. — plotModelMetric","text":"Plot diagnostics many initialized PARAFAC models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelMetric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics of many initialized PARAFAC models. — plotModelMetric","text":"","code":"plotModelMetric(   metric,   plottingMode = \"box\",   ylabel = \"metric\",   titleString = \"\" )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelMetric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics of many initialized PARAFAC models. — plotModelMetric","text":"metric Matrix metrics per initialized model (number models x number components). plottingMode Plot metrics box plot (\"box\", default) bar plot (\"bar\"). ylabel String y axis label (default \"metric\"). titleString String plot title (default \"\").","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelMetric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diagnostics of many initialized PARAFAC models. — plotModelMetric","text":"plot metrics","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelMetric.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diagnostics of many initialized PARAFAC models. — plotModelMetric","text":"","code":"varExp = array(runif(100*2, min=50, max=100), c(100,2)) plotModelMetric(varExp, plottingMode=\"box\", ylabel=\"Variation explained (%)\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelStability.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a summary of the loadings of many initialized parafac models. — plotModelStability","title":"Plot a summary of the loadings of many initialized parafac models. — plotModelStability","text":"Plot summary loadings many initialized parafac models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelStability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a summary of the loadings of many initialized parafac models. — plotModelStability","text":"","code":"plotModelStability(   models,   dataset,   colourCols = NULL,   legendTitles = NULL,   xLabels = NULL,   legendColNums = NULL,   arrangeModes = NULL,   continuousModes = NULL,   overallTitle = \"\" )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelStability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a summary of the loadings of many initialized parafac models. — plotModelStability","text":"models Models list output parafac() using output=\"\". dataset longitudinal microbiome dataset, ideally processed processDataCube(), formatted follows: data Array object data cube mode1 Dataframe subject metadata, ordered rows data cube. mode2 Taxonomic classification microbiota, ordered columns data cube. mode3 Dataframe time metadata, ordered third dimension array. colourCols Vector strings stating column names factorized colours per mode. legendTitles Vector strings stating legend title per mode. xLabels Vector strings stating x-axis labels per mode. legendColNums Vector integers stating desired number columns legends per mode. arrangeModes Vector boolean values per mode, stating loadings arranged according colourCols (TRUE) (FALSE). continuousModes Vector boolean values per mode, stating loadings plotted line plot (TRUE) bar plot (FALSE). overallTitle Overall title plot.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelStability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a summary of the loadings of many initialized parafac models. — plotModelStability","text":"Plot loadings error bars","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelStability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a summary of the loadings of many initialized parafac models. — plotModelStability","text":"","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2) models = parafac(processedFujita$data, 2, nstart=10, output=\"all\") plotModelStability(models, processedFujita)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelTCCs.html","id":null,"dir":"Reference","previous_headings":"","what":"Plots Tucker Congruence Coefficients of randomly initialized models. — plotModelTCCs","title":"Plots Tucker Congruence Coefficients of randomly initialized models. — plotModelTCCs","text":"Plots Tucker Congruence Coefficients randomly initialized models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelTCCs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plots Tucker Congruence Coefficients of randomly initialized models. — plotModelTCCs","text":"","code":"plotModelTCCs(models)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelTCCs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plots Tucker Congruence Coefficients of randomly initialized models. — plotModelTCCs","text":"models Models list output parafac() using output=\"\".","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelTCCs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plots Tucker Congruence Coefficients of randomly initialized models. — plotModelTCCs","text":"Plot TCCs","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotModelTCCs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plots Tucker Congruence Coefficients of randomly initialized models. — plotModelTCCs","text":"","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2) models = parafac(processedFujita$data, 3, nstart=10, output=\"all\") plotModelTCCs(models)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotPARAFACmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a PARAFAC model — plotPARAFACmodel","title":"Plot a PARAFAC model — plotPARAFACmodel","text":"Plot PARAFAC model","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotPARAFACmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a PARAFAC model — plotPARAFACmodel","text":"","code":"plotPARAFACmodel(   model,   dataset,   numComponents,   colourCols = NULL,   legendTitles = NULL,   xLabels = NULL,   legendColNums = NULL,   arrangeModes = NULL,   continuousModes = NULL,   overallTitle = \"\" )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotPARAFACmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a PARAFAC model — plotPARAFACmodel","text":"model Model output parafac(). dataset longitudinal microbiome dataset, ideally processed processDataCube(), formatted follows: data Array object data cube mode1 Dataframe subject metadata, ordered rows data cube. mode2 Taxonomic classification microbiota, ordered columns data cube. mode3 Dataframe time metadata, ordered third dimension array. numComponents Number PARAFAC components model. colourCols Vector strings stating column names factorized colours per mode. legendTitles Vector strings stating legend title per mode. xLabels Vector strings stating x-axis labels per mode. legendColNums Vector integers stating desired number columns legends per mode. arrangeModes Vector boolean values per mode, stating loadings arranged according colourCols (TRUE) (FALSE). continuousModes Vector boolean values per mode, stating loadings plotted line plot (TRUE) bar plot (FALSE). overallTitle Overall title plot.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotPARAFACmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a PARAFAC model — plotPARAFACmodel","text":"Plot object","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/plotPARAFACmodel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a PARAFAC model — plotPARAFACmodel","text":"","code":"library(multiway) #> Loading required package: CMLS #> Loading required package: quadprog #> Loading required package: parallel #>  #> Attaching package: ‘multiway’ #> The following objects are masked from ‘package:parafac4microbiome’: #>  #>     corcondia, parafac library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union library(ggplot2) set.seed(0)  # Make PARAFAC model processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2) model = parafac(processedFujita$data, nfac=3, nstart=100, verbose=FALSE)  # Make plot plotPARAFACmodel(model, processedFujita,   numComponents = 3,   colourCols = c(\"\", \"Genus\", \"\"),   legendTitles = c(\"\", \"Genus\", \"\"),   xLabels = c(\"Replicate\", \"Feature index\", \"Time point\"),   legendColNums = c(0,5,0),   arrangeModes = c(FALSE, TRUE, FALSE),   continuousModes = c(FALSE,FALSE,TRUE),   overallTitle = \"Fujita PARAFAC model\")"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html","id":null,"dir":"Reference","previous_headings":"","what":"Process a multi-way array of count data. — processDataCube","title":"Process a multi-way array of count data. — processDataCube","text":"Process multi-way array count data.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process a multi-way array of count data. — processDataCube","text":"","code":"processDataCube(   dataset,   sparsityThreshold = 1,   considerGroups = FALSE,   groupVariable = \"\",   CLR = TRUE,   centerMode = 0,   scaleMode = 0 )"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process a multi-way array of count data. — processDataCube","text":"dataset longitudinal microbiome dataset, formatted follows: data Array object data cube filled counts mode1 Dataframe subject metadata, ordered rows data cube. mode2 Taxonomic classification microbiota, ordered columns data cube. mode3 Dataframe time metadata, ordered third dimension array. See Fujita2023, Shao2019 vanderPloeg2024 information. sparsityThreshold Maximum sparsity feature selected (default=1, .e. select features). considerGroups Consider groups calculating sparsity (default=FALSE). groupVariable Column name dataset$mode1 used consider groups (default=\"\"). CLR Perform centered log-ratio transformation count data (default=TRUE). centerMode Mode center across: 1=subjects,2=features,3=time (default 0, .e. center). See multiwayCenter() information. scaleMode Mode scale within: 1=subjects,2=features,3=time (default 0, .e. scale). See multiwayScale() information.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process a multi-way array of count data. — processDataCube","text":"CLRed, centered scaled cube","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/processDataCube.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Process a multi-way array of count data. — processDataCube","text":"","code":"processedCube = processDataCube(Fujita2023)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateFac.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Xhat from a model Fac object — reinflateFac","title":"Calculate Xhat from a model Fac object — reinflateFac","text":"Calculate Xhat model Fac object","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateFac.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Xhat from a model Fac object — reinflateFac","text":"","code":"reinflateFac(Fac, X, returnAsTensor = FALSE)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateFac.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Xhat from a model Fac object — reinflateFac","text":"Fac Fac object parafac X Input data X returnAsTensor Boolean return Xhat rTensor tensor (TRUE) matrix (default, FALSE).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateFac.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Xhat from a model Fac object — reinflateFac","text":"Xhat","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateFac.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Xhat from a model Fac object — reinflateFac","text":"","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2) model = parafac(processedFujita$data, nfac=1, nstart=1, verbose=FALSE) Xhat = reinflateFac(model$Fac, processedFujita$data) #> Error in Fac[[1]]: subscript out of bounds"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateTensor.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a tensor out of a set of matrices similar to a component model. — reinflateTensor","title":"Create a tensor out of a set of matrices similar to a component model. — reinflateTensor","text":"Create tensor set matrices similar component model.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateTensor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a tensor out of a set of matrices similar to a component model. — reinflateTensor","text":"","code":"reinflateTensor(A, B, C, returnAsTensor = FALSE)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateTensor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a tensor out of a set of matrices similar to a component model. — reinflateTensor","text":"x N matrix corresponding loadings first mode N components. B J x N matrix corresponding loadings second mode N components. C K x N matrix corresponding loadings third mode N components. returnAsTensor Boolean return rTensor S4 tensor object (default FALSE).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateTensor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a tensor out of a set of matrices similar to a component model. — reinflateTensor","text":"M, x J x K tensor.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/reinflateTensor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a tensor out of a set of matrices similar to a component model. — reinflateTensor","text":"","code":"A = rnorm(108) B = rnorm(100) C = rnorm(10) M = reinflateTensor(A,B,C)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sortComponents.html","id":null,"dir":"Reference","previous_headings":"","what":"Sort PARAFAC components based on variance explained per component. — sortComponents","title":"Sort PARAFAC components based on variance explained per component. — sortComponents","text":"Sort PARAFAC components based variance explained per component.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sortComponents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sort PARAFAC components based on variance explained per component. — sortComponents","text":"","code":"sortComponents(Fac, X)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sortComponents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sort PARAFAC components based on variance explained per component. — sortComponents","text":"Fac Fac object output PARAFAC model X Input data","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sortComponents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sort PARAFAC components based on variance explained per component. — sortComponents","text":"Fac object sorted components","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sortComponents.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sort PARAFAC components based on variance explained per component. — sortComponents","text":"","code":"X = array(rnorm(108*100*10), c(108,100,10)) model = parafac(X, 2) #>    |                                                                               |                                                                      |   0%   |                                                                               |=======                                                               |  10%   |                                                                               |==============                                                        |  20%   |                                                                               |=====================                                                 |  30%   |                                                                               |============================                                          |  40%   |                                                                               |===================================                                   |  50%   |                                                                               |==========================================                            |  60%   |                                                                               |=================================================                     |  70%   |                                                                               |========================================================              |  80%   |                                                                               |===============================================================       |  90%   |                                                                               |======================================================================| 100% sortedFac = sortComponents(model$Fac, X) #> Error in Fac[[1]]: subscript out of bounds"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sumsqr.html","id":null,"dir":"Reference","previous_headings":"","what":"Sum-of-squares calculation — sumsqr","title":"Sum-of-squares calculation — sumsqr","text":"Sum--squares calculation","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sumsqr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sum-of-squares calculation — sumsqr","text":"","code":"sumsqr(X, na.rm = FALSE)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sumsqr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sum-of-squares calculation — sumsqr","text":"X Either list containing matrices, matrix values. na.rm Remove NAs calculation (default FALSE).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sumsqr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sum-of-squares calculation — sumsqr","text":"sum--squares object","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/sumsqr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sum-of-squares calculation — sumsqr","text":"","code":"X = array(rnorm(108*100*10), c(108,100,10)) ssq = sumsqr(X)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/transformPARAFACloadings.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform PARAFAC loadings to an orthonormal basis. Note: this function only works for 3-way PARAFAC models. — transformPARAFACloadings","title":"Transform PARAFAC loadings to an orthonormal basis. Note: this function only works for 3-way PARAFAC models. — transformPARAFACloadings","text":"Transform PARAFAC loadings orthonormal basis. Note: function works 3-way PARAFAC models.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/transformPARAFACloadings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform PARAFAC loadings to an orthonormal basis. Note: this function only works for 3-way PARAFAC models. — transformPARAFACloadings","text":"","code":"transformPARAFACloadings(Fac, modeToCorrect, moreOutput = FALSE)"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/transformPARAFACloadings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform PARAFAC loadings to an orthonormal basis. Note: this function only works for 3-way PARAFAC models. — transformPARAFACloadings","text":"Fac Fac object PARAFAC object, see parafac(). modeToCorrect Correct subject (1), feature (2) time mode (3). moreOutput Give orthonormal basis transformation matrices part output (default FALSE).","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/transformPARAFACloadings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform PARAFAC loadings to an orthonormal basis. Note: this function only works for 3-way PARAFAC models. — transformPARAFACloadings","text":"Corrected loadings specified mode.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/transformPARAFACloadings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform PARAFAC loadings to an orthonormal basis. Note: this function only works for 3-way PARAFAC models. — transformPARAFACloadings","text":"","code":"processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2) model = parafac(processedFujita$data, nfac=2, nstart=1, verbose=FALSE) transformedA = transformPARAFACloadings(model$Fac, 1) #> Error in Fac[[1]]: subscript out of bounds"},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html","id":null,"dir":"Reference","previous_headings":"","what":"vanderPloeg2024 longitudinal microbiome data — vanderPloeg2024","title":"vanderPloeg2024 longitudinal microbiome data — vanderPloeg2024","text":"vanderPloeg2024 longitudinal microbiome dataset three-dimensional array, subjects mode 1, microbial abundances mode 2, time mode 3. Note: -zero microbial abundances removed save disk space.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"vanderPloeg2024 longitudinal microbiome data — vanderPloeg2024","text":"","code":"vanderPloeg2024"},{"path":[]},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html","id":"vanderploeg-","dir":"Reference","previous_headings":"","what":"vanderPloeg2024","title":"vanderPloeg2024 longitudinal microbiome data — vanderPloeg2024","text":"list object three elements: data Array object data cube mode1 Dataframe subject metadata, ordered rows data cube. mode2 Taxonomic classification microbiota, ordered columns data cube. mode3 Dataframe time metadata, ordered third dimension array.","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/reference/vanderPloeg2024.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"vanderPloeg2024 longitudinal microbiome data — vanderPloeg2024","text":"<https://doi.org/10.1101/2024.03.18.585469 >","code":""},{"path":"https://grvanderploeg.github.io/parafac4microbiome/news/index.html","id":"parafac4microbiome-002","dir":"Changelog","previous_headings":"","what":"parafac4microbiome 0.0.2","title":"parafac4microbiome 0.0.2","text":"Added NEWS.md","code":""}]
