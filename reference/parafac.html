<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fits Richard A. Harshman's Parallel Factors (Parafac) model to 3-way or 4-way data arrays. Parameters are estimated via alternating least squares with optional constraints."><title>Parallel Factor Analysis-1 — parafac • parafac4microbiome</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parallel Factor Analysis-1 — parafac"><meta property="og:description" content="Fits Richard A. Harshman's Parallel Factors (Parafac) model to 3-way or 4-way data arrays. Parameters are estimated via alternating least squares with optional constraints."><meta property="og:image" content="https://grvanderploeg.github.io/parafac4microbiome/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">parafac4microbiome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Fujita2023_analysis.html">Fujita2023_analysis</a>
    <a class="dropdown-item" href="../articles/PARAFAC_introduction.html">Introduction to PARAFAC modelling</a>
    <a class="dropdown-item" href="../articles/Shao2019_analysis.html">Shao2019_analysis</a>
    <a class="dropdown-item" href="../articles/vanderPloeg2024_analysis.html">vanderPloeg2024_analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Parallel Factor Analysis-1</h1>
      
      <div class="d-none name"><code>parafac.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits Richard A. Harshman's Parallel Factors (Parafac) model to 3-way or 4-way data arrays. Parameters are estimated via alternating least squares with optional constraints.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">parafac</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">nfac</span>,</span>
<span>  nstart <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  const <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Afixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Bfixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Cfixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dfixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Astart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Bstart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Cstart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dstart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Astruc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Bstruc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Cstruc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dstruc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Amodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Bmodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Cmodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Dmodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  ctol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"best"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  backfit <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>Three-way data array with dim=c(I,J,K) or four-way data array with dim=c(I,J,K,L). Missing data are allowed (see Note).</p></dd>


<dt>nfac</dt>
<dd><p>Number of factors.</p></dd>


<dt>nstart</dt>
<dd><p>Number of random starts.</p></dd>


<dt>const</dt>
<dd><p>Character vector of length 3 or 4 giving the constraints for each mode (defaults to unconstrained). See <a href="https://rdrr.io/pkg/CMLS/man/const.html" class="external-link">CMLS::const</a> for the 24 available options.</p></dd>


<dt>control</dt>
<dd><p>List of parameters controlling options for smoothness constraints. This is passed to <a href="https://rdrr.io/pkg/multiway/man/const.control.html" class="external-link">multiway::const.control</a>, which describes the available options.</p></dd>


<dt>Afixed</dt>
<dd><p>Used to fit model with fixed Mode A weights.</p></dd>


<dt>Bfixed</dt>
<dd><p>Used to fit model with fixed Mode B weights.</p></dd>


<dt>Cfixed</dt>
<dd><p>Used to fit model with fixed Mode C weights.</p></dd>


<dt>Dfixed</dt>
<dd><p>Used to fit model with fixed Mode D weights.</p></dd>


<dt>Astart</dt>
<dd><p>Starting Mode A weights. Default uses random weights.</p></dd>


<dt>Bstart</dt>
<dd><p>Starting Mode B weights. Default uses random weights.</p></dd>


<dt>Cstart</dt>
<dd><p>Starting Mode C weights. Default uses random weights.</p></dd>


<dt>Dstart</dt>
<dd><p>Starting Mode D weights. Default uses random weights.</p></dd>


<dt>Astruc</dt>
<dd><p>Structure constraints for Mode A weights. See Note.</p></dd>


<dt>Bstruc</dt>
<dd><p>Structure constraints for Mode B weights. See Note.</p></dd>


<dt>Cstruc</dt>
<dd><p>Structure constraints for Mode C weights. See Note.</p></dd>


<dt>Dstruc</dt>
<dd><p>Structure constraints for Mode D weights. See Note.</p></dd>


<dt>Amodes</dt>
<dd><p>Mode ranges for Mode A weights (for unimodality constraints). See Note.</p></dd>


<dt>Bmodes</dt>
<dd><p>Mode ranges for Mode B weights (for unimodality constraints). See Note.</p></dd>


<dt>Cmodes</dt>
<dd><p>Mode ranges for Mode C weights (for unimodality constraints). See Note.</p></dd>


<dt>Dmodes</dt>
<dd><p>Mode ranges for Mode D weights (for unimodality constraints). See Note.</p></dd>


<dt>maxit</dt>
<dd><p>Maximum number of iterations.</p></dd>


<dt>ctol</dt>
<dd><p>Convergence tolerance (R^2 change).</p></dd>


<dt>parallel</dt>
<dd><p>Logical indicating if <a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parallel::parLapply</a> should be used. See Examples.</p></dd>


<dt>cl</dt>
<dd><p>Cluster created by <a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster</a>. Only used when parallel=TRUE.</p></dd>


<dt>output</dt>
<dd><p>Output the best solution (default) or output all nstart solutions.</p></dd>


<dt>verbose</dt>
<dd><p>If TRUE, fitting progress is printed via <a href="https://rdrr.io/r/utils/txtProgressBar.html" class="external-link">utils::txtProgressBar</a>. Ignored if parallel=TRUE.</p></dd>


<dt>backfit</dt>
<dd><p>Should backfitting algorithm be used for <a href="https://rdrr.io/pkg/CMLS/man/cmls.html" class="external-link">CMLS::cmls</a>?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If output = "best", returns an object of class "parafac" with the following elements:
#'</p><dl><dt>A</dt>
<dd><p>Mode A weight matrix.</p></dd>

<dt>B</dt>
<dd><p>Mode B weight matrix.</p></dd>

<dt>C</dt>
<dd><p>Mode C weight matrix.</p></dd>

<dt>D</dt>
<dd><p>Mode D weight matrix.</p></dd>

<dt>SSE</dt>
<dd><p>Sum of Squared Errors.</p></dd>

<dt>Rsq</dt>
<dd><p>R-squared value.</p></dd>

<dt>GCV</dt>
<dd><p>Generalized Cross-Validation.</p></dd>

<dt>edf</dt>
<dd><p>Effective degrees of freedom.</p></dd>

<dt>iter</dt>
<dd><p>Number of iterations.</p></dd>

<dt>cflag</dt>
<dd><p>Convergence flag. See Note.</p></dd>

<dt>const</dt>
<dd><p>See argument const.</p></dd>

<dt>control</dt>
<dd><p>See argument control.</p></dd>

<dt>fixed</dt>
<dd><p>Logical vector indicating whether 'fixed' weights were used for each mode.</p></dd>

<dt>struc</dt>
<dd><p>Logical vector indicating whether 'struc' constraints were used for each mode.</p></dd>


</dl><p>Otherwise returns a list of length nstart where each element is an object of class "parafac".</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Missing data should be specified as NA values in the input X. The missing data are randomly initialized and then iteratively imputed as a part of the algorithm.</p>
<p>Structure constraints should be specified with a matrix of logicals (TRUE/FALSE), such that FALSE elements indicate a weight should be constrained to be zero. Default uses unstructured weights, i.e., a matrix of all TRUE values.</p>
<p>When using unimodal constraints, the *modes inputs can be used to specify the mode search range for each factor. These inputs should be matrices with dimension c(2,nfac) where the first row gives the minimum mode value and the second row gives the maximum mode value (with respect to the indicies of the corresponding weight matrix).</p>
<p>Output cflag gives convergence information: cflag = 0 if algorithm converged normally, cflag = 1 if maximum iteration limit was reached before convergence, and cflag = 2 if algorithm terminated abnormally due to a problem with the constraints.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">multiway</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#' ##########   3-way example   ##########</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create random data array with Parafac structure</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mydim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">20</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nf</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">Amat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">nf</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">nf</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Cmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">nf</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">Amat</span>, <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/krprod.html" class="external-link">krprod</a></span><span class="op">(</span><span class="va">Cmat</span>, <span class="va">Bmat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">Xmat</span>, dim <span class="op">=</span> <span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/nscale.html" class="external-link">nscale</a></span><span class="op">(</span><span class="va">Emat</span>, <span class="fl">0</span>, ssnew <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/sumsq.html" class="external-link">sumsq</a></span><span class="op">(</span><span class="va">Xmat</span><span class="op">)</span><span class="op">)</span>   <span class="co"># SNR = 1</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Xmat</span> <span class="op">+</span> <span class="va">Emat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit Parafac model (unconstrained)</span></span></span>
<span class="r-in"><span><span class="va">pfac</span> <span class="op">&lt;-</span> <span class="fu">parafac</span><span class="op">(</span><span class="va">X</span>, nfac <span class="op">=</span> <span class="va">nf</span>, nstart <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">pfac</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3-way Parafac with 3 factors </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A      B      C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  uncons uncons uncons</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSE = 950.3324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   R^2 = 0.5149861 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GCV = 0.2078778 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   EDF = 219 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged: TRUE (15 iterations)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit Parafac model (non-negativity on Modes B and C)</span></span></span>
<span class="r-in"><span><span class="va">pfacNN</span> <span class="op">&lt;-</span> <span class="fu">parafac</span><span class="op">(</span><span class="va">X</span>, nfac <span class="op">=</span> <span class="va">nf</span>, nstart <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            const <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uncons"</span>, <span class="st">"nonneg"</span>, <span class="st">"nonneg"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">pfacNN</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3-way Parafac with 3 factors </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A      B      C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  uncons nonneg nonneg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSE = 950.1934 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   R^2 = 0.515057 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GCV = 0.2078474 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   EDF = 219 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged: TRUE (12 iterations)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check solution</span></span></span>
<span class="r-in"><span><span class="va">Xhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Xmat</span> <span class="op">-</span> <span class="va">Xhat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008264583</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reorder and resign factors</span></span></span>
<span class="r-in"><span><span class="va">pfac</span><span class="op">$</span><span class="va">B</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.2993941 -0.9361133 -0.3507422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.3731378 -0.3491355 -0.4316282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.4244651 -0.8101654 -1.0452068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.9485296 -0.8058645 -0.5985801</span>
<span class="r-in"><span><span class="va">pfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">pfac</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pfac</span><span class="op">$</span><span class="va">B</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3507422 -0.2993941 -0.9361133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.4316282 -0.3731378 -0.3491355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1.0452068 -1.4244651 -0.8101654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.5985801 -0.9485296 -0.8058645</span>
<span class="r-in"><span><span class="va">pfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/resign.html" class="external-link">resign</a></span><span class="op">(</span><span class="va">pfac</span>, mode<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pfac</span><span class="op">$</span><span class="va">B</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.3507422 0.2993941 0.9361133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4316282 0.3731378 0.3491355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.0452068 1.4244651 0.8101654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.5985801 0.9485296 0.8058645</span>
<span class="r-in"><span><span class="va">Xhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Xmat</span> <span class="op">-</span> <span class="va">Xhat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008264583</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rescale factors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">$</span><span class="va">B</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20 20 20</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">$</span><span class="va">C</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2374967 0.6032392 0.2727013</span>
<span class="r-in"><span><span class="va">pfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/rescale.html" class="external-link">rescale</a></span><span class="op">(</span><span class="va">pfac</span>, mode <span class="op">=</span> <span class="st">"C"</span>, absorb <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">$</span><span class="va">B</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9499866 2.4129567 1.0908051</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">$</span><span class="va">C</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5 5 5</span>
<span class="r-in"><span><span class="va">Xhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Xmat</span> <span class="op">-</span> <span class="va">Xhat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008264583</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##########   4-way example   ##########</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create random data array with Parafac structure</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mydim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">10</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nf</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">aseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, length.out <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Amat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">aseq</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">dchisq</a></span><span class="op">(</span><span class="va">aseq</span><span class="op">+</span><span class="fl">3.1</span>, df<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">aseq</span><span class="op">-</span><span class="fl">2</span>, df<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">aseq</span><span class="op">+</span><span class="fl">3.1</span>, shape<span class="op">=</span><span class="fl">3</span>, rate<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Bmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">nf</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nf</span><span class="op">)</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span></span>
<span class="r-in"><span><span class="va">Cmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">nf</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Cstruc</span> <span class="op">&lt;-</span> <span class="va">Cmat</span> <span class="op">&gt;</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">Cmat</span> <span class="op">&lt;-</span> <span class="va">Cmat</span> <span class="op">*</span> <span class="va">Cstruc</span></span></span>
<span class="r-in"><span><span class="va">Dmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">nf</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">mydim</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">Amat</span>, <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/krprod.html" class="external-link">krprod</a></span><span class="op">(</span><span class="va">Dmat</span>, <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/krprod.html" class="external-link">krprod</a></span><span class="op">(</span><span class="va">Cmat</span>, <span class="va">Bmat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Xmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="va">Xmat</span>, dim <span class="op">=</span> <span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/nscale.html" class="external-link">nscale</a></span><span class="op">(</span><span class="va">Emat</span>, <span class="fl">0</span>, ssnew <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multiway/man/sumsq.html" class="external-link">sumsq</a></span><span class="op">(</span><span class="va">Xmat</span><span class="op">)</span><span class="op">)</span>   <span class="co"># SNR = 1</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Xmat</span> <span class="op">+</span> <span class="va">Emat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit Parafac model (unimodal and smooth A, orthogonal B,</span></span></span>
<span class="r-in"><span><span class="co">#                    non-negative and structured C, non-negative D)</span></span></span>
<span class="r-in"><span><span class="va">pfac</span> <span class="op">&lt;-</span> <span class="fu">parafac</span><span class="op">(</span><span class="va">X</span>, nfac <span class="op">=</span> <span class="va">nf</span>, nstart <span class="op">=</span> <span class="fl">1</span>, Cstruc <span class="op">=</span> <span class="va">Cstruc</span>,</span></span>
<span class="r-in"><span>            const <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unismo"</span>, <span class="st">"orthog"</span>, <span class="st">"nonneg"</span>, <span class="st">"nonneg"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="va">pfac</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4-way Parafac with 4 factors </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A      B             C      D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  unismo orthog nonneg+struct nonneg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit Information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSE = 42.48407 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   R^2 = 0.4873829 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GCV = 0.001785761 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   EDF = 105 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged: TRUE (7 iterations)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check solution</span></span></span>
<span class="r-in"><span><span class="va">Xhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Xmat</span> <span class="op">-</span> <span class="va">Xhat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">mydim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.132859e-05</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/multiway/man/congru.html" class="external-link">congru</a></span><span class="op">(</span><span class="va">Amat</span>, <span class="va">pfac</span><span class="op">$</span><span class="va">A</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]      [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9996716 0.7287234 0.4135958 -0.8044008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.7123512 0.9990610 0.3778488 -0.9789737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.4145023 0.3786920 0.9986611 -0.4571581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.8712777 0.9374104 0.4200941 -0.9332070</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">pfac</span><span class="op">$</span><span class="va">B</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]         [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.000000e+01 3.345089e-15  9.014050e-16 -1.413387e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  3.345089e-15 1.000000e+01  1.207936e-15  2.749057e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  9.014050e-16 1.207936e-15  1.000000e+01 -4.394494e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.413387e-15 2.749057e-15 -4.394494e-16  1.000000e+01</span>
<span class="r-in"><span><span class="va">pfac</span><span class="op">$</span><span class="va">C</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]      [,2]          [,3]      [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.429197e+00 1.0865265 -1.062753e-19 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 7.471576e-19 0.8404925  6.669612e-36 1.2003143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 8.760174e-01 0.0000000  1.477234e+00 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.000000e+00 1.1272930  1.090825e+00 0.8922219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 1.342355e+00 1.3602890  9.173661e-01 1.3893746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 1.709773e-19 1.1615836  0.000000e+00 1.6053098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,] 1.289349e+00 1.2816319  1.307693e+00 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,] 1.313641e+00 0.0000000  1.440923e+00 1.1206267</span>
<span class="r-in"><span><span class="va">Cstruc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]  [,3]  [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  TRUE  TRUE FALSE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] FALSE  TRUE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  TRUE FALSE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] FALSE  TRUE  TRUE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  TRUE  TRUE  TRUE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] FALSE  TRUE FALSE  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7,]  TRUE  TRUE  TRUE FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8,]  TRUE FALSE  TRUE  TRUE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Roel van der Ploeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

